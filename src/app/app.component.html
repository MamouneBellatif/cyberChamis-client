<h1>Projet intégrateur L3 Miage 2022</h1>
<h2>Bienvenue chez les chamis</h2>
<section *ngIf="auth.user | async as user; else showLogin">
<div>
  <img src="{{ user.photoURL }}" 
       width="50px"
  />
  <h2>{{ user.displayName }}</h2>
  <input type="button"
         (click)="logout()"
         value="Logout"
  />
  <section *ngIf="user.email !== null"> 
    <section *ngIf="getChamiByEmail(user.email) | async as chami; else chamiInexistant">
      Bienvenue {{chami.login}} !
    </section>
  </section>

  <ng-template #chamiInexistant>
    Créez votre profil de Chami 
    <section *ngIf="user.email !== null">
      <form (submit)="addChami({login: loginChami.value,
                                age: parseAge(ageChami.value),
                                defis: [],
                                email: user.email
                              }); loginChami.value=''; ageChami.value=''">
        <input #loginChami
              type="text"
              name="loginChami"
              placeholder="Votre login"
              />
        <input #ageChami
                type="number"
                name="age"
                placeholder="Votre âge"/>
      </form>
    </section>
    
  </ng-template>
</div>

<app-list-chamis></app-list-chamis>
<app-list-defis></app-list-defis>

<label>
  Afficher le cercle
  <input type="checkbox" [(ngModel)]="displayCircle" />
</label>

<div style="height: 300px;"
     leaflet 
     [leafletOptions]="options"
     [leafletLayers]="otherLayers">

     <div *ngIf="displayCircle" [leafletLayer]="layerCircle"></div>
</div>
</section>

<ng-template #showLogin>
  <p>Veuillez vous authentifier.</p>
  <input type="button" 
         (click)="login()"
         value="Login with Google"
  />
</ng-template>